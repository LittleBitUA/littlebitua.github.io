---
// ─── Header ────────────────────────────────────────────────────
// Floating pill-style navbar, centered, minimal and premium.

import { getOverallProgress } from "../data/games";
const overall = getOverallProgress();
---

<header id="site-header" class="fixed top-0 left-0 right-0 z-50 pt-2 sm:pt-4 px-2 sm:px-4 transition-all duration-500">
  <nav class="mx-auto max-w-6xl lg:max-w-4xl">
    <div class="header-pill flex items-center justify-between h-10 sm:h-12 px-1.5 sm:px-2 rounded-xl sm:rounded-2xl
                bg-surface-800/60 backdrop-blur-xl border border-white/[0.06]
                shadow-lg shadow-black/20 transition-all duration-500">

      <!-- Logo -->
      <a href="/" class="flex items-center gap-2 px-2 group shrink-0">
        <div class="w-7 h-7 rounded-lg bg-[#1a1a1a] border border-white/10
                    flex items-center justify-center
                    group-hover:shadow-md group-hover:shadow-white/10 transition-all duration-300 overflow-hidden">
          <svg viewBox="0 0 40 40" class="w-full h-full">
            <rect width="40" height="40" rx="8" fill="#1a1a1a"/>
            <text x="50%" y="54%" dominant-baseline="middle" text-anchor="middle"
                  font-family="Inter, system-ui, sans-serif" font-weight="900" font-size="20" fill="white"
                  letter-spacing="-1">LB</text>
          </svg>
        </div>
        <span class="text-white font-bold text-sm hidden sm:block">
          «Little Bit»
        </span>
      </a>

      <!-- Nav links - always visible -->
      <div class="flex items-center gap-0.5 sm:gap-1">
        <a href="/projects" class="nav-link px-2 sm:px-3 py-1.5 text-[10px] sm:text-xs font-medium text-surface-300 hover:text-white
                                   rounded-lg hover:bg-white/[0.06] transition-all duration-200">
          Проєкти
        </a>
        <a href="#launcher" class="nav-link px-2 sm:px-3 py-1.5 text-[10px] sm:text-xs font-medium text-surface-300 hover:text-white
                                   rounded-lg hover:bg-white/[0.06] transition-all duration-200">
          Лаунчер
        </a>
        <a href="#support" class="nav-link px-2 sm:px-3 py-1.5 text-[10px] sm:text-xs font-medium text-surface-300 hover:text-white
                                  rounded-lg hover:bg-white/[0.06] transition-all duration-200">
          Підтримати
        </a>
        <a href="#faq" class="nav-link px-2 sm:px-3 py-1.5 text-[10px] sm:text-xs font-medium text-surface-300 hover:text-white
                              rounded-lg hover:bg-white/[0.06] transition-all duration-200">
          FAQ
        </a>
      </div>

      <!-- Right side -->
      <div class="flex items-center shrink-0">
        <!-- Donate button -->
        <a
          href="/#support"
          class="inline-flex items-center justify-center gap-1 w-8 h-8 sm:w-auto sm:px-3.5 sm:py-1.5 text-xs font-semibold
                 bg-accent/15 text-accent-light border border-accent/25 rounded-lg sm:rounded-xl
                 hover:bg-accent/25 hover:border-accent/40 transition-all duration-200"
          aria-label="Підтримати проєкт"
        >
          <svg class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
          </svg>
          <span class="hidden sm:inline text-xs leading-none">Підтримати</span>
        </a>
      </div>
    </div>
  </nav>
</header>

<style>
  /* Active nav link highlight based on scroll position */
  .nav-link.active {
    color: white;
    background: rgba(255, 255, 255, 0.06);
  }

  /* Shrink pill on scroll */
  .header-scrolled .header-pill {
    background: rgba(13, 17, 23, 0.85);
    border-color: rgba(255, 255, 255, 0.08);
  }
</style>

<script>
  const header = document.getElementById("site-header")!;

  // ── Scroll: add background ──
  const onScroll = () => {
    header.classList.toggle("header-scrolled", window.scrollY > 32);
  };
  window.addEventListener("scroll", onScroll, { passive: true });
  onScroll();

  // ── Active section highlight ──
  const sections = document.querySelectorAll("section[id]");
  const navLinks = document.querySelectorAll<HTMLAnchorElement>(".nav-link");

  const highlightNav = () => {
    let current = "";
    sections.forEach((section) => {
      const top = section.getBoundingClientRect().top;
      if (top <= 120) current = section.id;
    });
    navLinks.forEach((link) => {
      link.classList.toggle("active", link.getAttribute("href") === `#${current}`);
    });
  };
  window.addEventListener("scroll", highlightNav, { passive: true });
</script>
